[build]
builder = "nixpacks"
buildCommand = "npm run build"

[deploy]
# Run migrations then start app (automatic on every deploy)
startCommand = "npm run deploy"
healthcheckPath = "/api/health"
# Migrations run before app starts; use 5 min so healthcheck doesn't fail while DB runs
healthcheckTimeout = 300
restartPolicyType = "on_failure"
restartPolicyMaxRetries = 10
